  Merge PackageSerializer's and ProtoOutputFormatter's duplicated serialization logic.  Among other things, this fixes an out-of-sync bug where ProtoOutputFormatter's version knew how to handle configurable attributes while PackageSerializer's version crashed.  The merged logic preserves ProtoOutputFormatter's semantics: configurable attributes work, but their values are merged together into a flattened list, so the original select structure can't be reproduced later.  -- MOS_MIGRATED_REVID=89435116  