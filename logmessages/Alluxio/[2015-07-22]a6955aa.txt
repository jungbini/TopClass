  Add some more documentation and fix variable names.  