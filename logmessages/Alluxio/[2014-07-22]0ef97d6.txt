 refactorying master port to be immutable, and fixed a few unneeded things  