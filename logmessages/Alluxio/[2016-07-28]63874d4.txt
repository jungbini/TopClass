  Add tests for failure cases and fix a failure case  