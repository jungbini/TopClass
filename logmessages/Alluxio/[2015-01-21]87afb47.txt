  use Guava to do parameter check, and fix testcase failure  