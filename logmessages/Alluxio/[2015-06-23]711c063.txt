  Add more unit tests for block heartbeat reporter and fix a bug.  