  fix review comments by jsimsa and resolve merge conflicts  