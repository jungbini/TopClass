 made fix more robust based on PR comments  