  Clean up block lock reference counting  Also fix a bug in the case where two threads acquire a block lock for the same block id at the same time.  