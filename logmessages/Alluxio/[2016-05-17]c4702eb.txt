  Use factory and fix bug.  