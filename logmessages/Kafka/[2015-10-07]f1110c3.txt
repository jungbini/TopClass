  KAFKA-2477: Fix a race condition between log append and fetch that causes OffsetOutOfRangeException.  Tried two fixes. I prefer the second approach because it saves an additional offset search.  Author: Jiangjie Qin <becket.qin@gmail.com>  Reviewers: Guozhang Wang <wangguoz@gmail.com>, Ismael Juma <ismael@juma.me.uk>, Jun Rao <junrao@gmail.com>  Closes #204 from becketqin/KAFKA-2477  