 fixed a bug regarding missing conditional check.  