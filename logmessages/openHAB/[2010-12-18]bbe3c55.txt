  fixed bugs and corrected Javadoc  