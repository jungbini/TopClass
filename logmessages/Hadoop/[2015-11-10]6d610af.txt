ry picked from commit b742ea7fe677def932e94abfa7d3fcec80ccfd93) (cherry picked from commit 373b29491f1fb34a7b83a300f01fbbe985b5b33d)  