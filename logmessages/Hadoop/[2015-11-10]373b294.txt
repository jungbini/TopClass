ry picked from commit b742ea7fe677def932e94abfa7d3fcec80ccfd93)  