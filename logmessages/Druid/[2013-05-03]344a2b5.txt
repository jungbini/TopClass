  numerous bug fixes and improvements according to code review  