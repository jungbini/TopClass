  fix partitionNum calculation & remove extra sorting  