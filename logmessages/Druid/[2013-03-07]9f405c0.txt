  fix constant segment balancing and separate out the 