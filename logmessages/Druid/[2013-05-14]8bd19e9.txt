  1) Take in g9yuayon's pull request, fix merge conflicts and formatting  