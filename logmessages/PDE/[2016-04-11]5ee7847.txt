  several fixes, cleanups, and speed improvements to dictionary classes  