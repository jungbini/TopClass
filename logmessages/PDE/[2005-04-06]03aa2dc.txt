  final fixes for 0082, full merge of simon's code  