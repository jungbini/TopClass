  bug fixes and more threading work  