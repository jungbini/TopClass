  fix issues with bad sketch names, improve error checking  