  continued work on bug #349  