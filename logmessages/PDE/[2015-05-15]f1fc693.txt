  rework non-visible surface handling, fix size() parser  