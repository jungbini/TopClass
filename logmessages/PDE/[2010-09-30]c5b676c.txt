 lots of bug fixes for 0191  