  write preferences using a temporary file (should fix #4614)  