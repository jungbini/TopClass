  adding createWriter and other minor fixes  