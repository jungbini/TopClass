  fix for using mask() under some circumstances  