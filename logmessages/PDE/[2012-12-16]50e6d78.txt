  some fixes in the surface handling logic  