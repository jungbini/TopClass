  rewrite simplifier to use the language functions and fix #3268  