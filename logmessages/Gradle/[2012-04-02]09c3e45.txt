  Moved some comlexity out of the ProtocolToModelAdapter so that it knows less about the domain model. It still knows about VersionDetails but I think I can fix that...  