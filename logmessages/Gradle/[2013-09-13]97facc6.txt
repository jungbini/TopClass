  REVIEW-2968 Sweet code review. Removed redundant method, made the code simpler, fixed an outstanding issue with in-memory task history cache.  