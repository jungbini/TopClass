  fix #1206 better processing for ranges  