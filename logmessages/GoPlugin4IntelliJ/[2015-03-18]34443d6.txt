  fix #1446: better processing for ranges and channel types  