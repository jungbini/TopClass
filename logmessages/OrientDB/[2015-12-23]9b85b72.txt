  refactor for fix infinite loop between begin response and async thread  