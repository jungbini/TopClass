  fixed #3889 + test  