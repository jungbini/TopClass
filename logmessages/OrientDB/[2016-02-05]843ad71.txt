  add encryption algorithm settings and fix java 7 compatibility  