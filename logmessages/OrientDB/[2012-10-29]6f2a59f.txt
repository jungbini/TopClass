  Fixed bug on using array [] in projections: reduced code, improved it and 1 new test case  