  Patch by Laszlo Hordos to fix issue 646  