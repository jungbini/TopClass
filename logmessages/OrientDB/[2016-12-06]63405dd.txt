  HA: fixed minor bugs according to the failing test cases  