  Patch by sizon5 to fix issue 689  