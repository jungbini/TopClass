  Added a test case(distributed) and a fix  