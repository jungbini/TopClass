  Partially fixed issue #4309  