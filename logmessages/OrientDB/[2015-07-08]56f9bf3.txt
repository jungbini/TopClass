  fixed #4473 and #3863  