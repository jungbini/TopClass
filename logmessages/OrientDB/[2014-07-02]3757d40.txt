  code clean up and minor fix.  