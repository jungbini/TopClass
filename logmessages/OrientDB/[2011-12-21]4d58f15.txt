  Contribution from Andrey and Artem to fix issue 569  