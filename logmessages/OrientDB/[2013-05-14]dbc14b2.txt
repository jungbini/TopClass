  readable clusters: removed duplicated code and fixed bug on polymorphic usage  