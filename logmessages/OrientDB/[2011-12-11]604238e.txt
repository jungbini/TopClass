  Contribution by Andrey to fix issue 636  