  add dirty fix for backward compatibility, add collection tracking. issue #681  