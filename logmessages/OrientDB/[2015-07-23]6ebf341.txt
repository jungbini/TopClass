  fixes to pattern matching + new test case  