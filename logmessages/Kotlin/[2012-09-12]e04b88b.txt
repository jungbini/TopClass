  fix endsWith, add isEmpty  (cherry-picked from 6cf1761)  