  Most of the tests fixed  