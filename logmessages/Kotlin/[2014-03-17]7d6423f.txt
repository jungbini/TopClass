  Minor, add assertion messages, fix warnings  