  Fix a bug where the data that follows an HTTP upgrade response is lost  Related issue: #2179 and #2173  Motivation:  When a WebSocket server responds to a WebSocket handshake request with its first WebSocket frame, it is sometimes swallowed by HttpMessageDecoder.  This issue has been fixed by 4f6ccbbb78c88c82aa02c77fe7592709cfbf7922 in 4 and 5, but was not.  Modification:  Backport the UPGRADED state and the fix for #2173 to HttpMessageDecoder  Result:  The data sent by the server following an HTTP upgrade response is not lost anymore.  