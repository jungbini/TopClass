ported 3a61696 [Lee moon soo] Add checkpoint() method implementation  