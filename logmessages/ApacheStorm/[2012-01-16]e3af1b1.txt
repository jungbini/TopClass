  partitionedtransactionalspout implementation plus fix up a few apis  