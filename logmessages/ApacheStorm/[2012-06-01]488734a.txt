 fix race condition - ensure that scheduling code is not called concurrently (this was a regression)  