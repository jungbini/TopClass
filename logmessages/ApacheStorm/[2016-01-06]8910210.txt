  address code review comments; make integration test more resilient; fix javadoc for retain parameter  