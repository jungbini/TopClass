  fix minor bug, cleanup code, optimized collector working  