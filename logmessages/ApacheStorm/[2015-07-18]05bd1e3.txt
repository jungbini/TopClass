  STORM-643 fixing based on master branch  also add UT  