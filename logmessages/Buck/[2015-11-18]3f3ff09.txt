  Fix Nailgun Python client on Windows (and fix stdin hang)  Summary: Previously, if any input was typed on the console of the Python nailgun client, the client would hang indefinitely trying to read until stdin was closed.  This was because even though we used `select()` to check if `sys.stdin` had anything to read, the API `f.readinto(buf)` would try to read `len(buf)` bytes regardless of how many bytes were available on stdin.  Because `sys.stdin` is blocking by default, this would cause the following hang in Python:  File "/path/to/buck/bin/../programs/buckd.py", line 35, in <module> propagate_failure(main(sys.argv)) File "/path/to/buck/bin/../programs/buckd.py", line 28, in main buck_repo.kill_buckd() File "/path/to/devtools/buck/programs/buck_tool.py", line 286, in kill_buckd c.send_command('ng-stop') File "/path/to/buck/third-party/nailgun/pynailgun/ng.py", line 128, in send_command self._process_next_chunk() File "/path/to/buck/third-party/nailgun/pynailgun/ng.py", line 144, in _process_next_chunk if not process_stdin(self): File "/path/to/buck/third-party/nailgun/pynailgun/ng.py", line 378, in process_stdin bytes_read = nailgun_connection.stdin.readinto(nailgun_connection.buf)  There are a few possible fixes:  1) Make `sys.stdin` nonblocking using `fcntl` 2) Use a separate thread to read from `sys.stdin`  I chose option 2), because `fcntl` is Unix-specific, and we need to use a separate thread for Windows anyway (since `select()` on Windows only works for sockets).  I also found a few places where I hard-coded `sys.stdin` instead of using the passed-in `self.stdin` (which could be `None`).  Test Plan: Tested with Python 2.6 on Linux and Python 2.7 on OS X. Windows testing forthcoming.  rm build/successful-build ./bin/buck  Typed characters on console. Previously, client would eventually hang with above stack trace (shown with `kill -USR1`).  Applied fix, repeated steps, no more hang.  Opened Xcode and ran `buck project //path/to:target` in Apple repo. Confirmed prompt to kill Xcode appeared, I could input a response, and response appeared.  Reviewed By: sdwilsh  fb-gh-sync-id: 672b571  