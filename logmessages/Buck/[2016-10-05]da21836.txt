is still an issue. Given that `commandIdToLogFileHandlerWriter` is a `ConcurrentMap`, and we only ever close old writers obtained with `ConcurrentMap.remove` / `ConcurrentMap.put`, I cannot see how could `GlobalStateManager` close a writer twice. That is under the assumption that `ConcurrentMap` really performs `remove` and `put` atomically. The only explanation I have is that the client closes those writers after obtaining them with `getLogFileHandlerState` which they shouldn't. However, I couldn't find such close calls. Another possibility is that we have multiple `ReferenceCountedWriters` entries in the `commandIdToLogFileHandlerWriter` map, all which point to the same underlying stream, but without the reference counter being properly updated. I cannot see how would that happen either.  This 