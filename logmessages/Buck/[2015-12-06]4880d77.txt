  Memory semaphore should use max memory not current memory  Summary: I think this is causing a bug where if the jvm hasn't reserved much memory at the time that TOTAL_MEMORY is set, the semaphore can have less than 600 entries which will cause it to never be able to reserve enough memory to do the highest level of lzma compression.  Test Plan: Built locally a bunch of times, builds kept getting stuck. Applied this patch to buck, things started working again.  Reviewed By: @stashuk  fb-gh-sync-id: 60e2a46  