  Refactor and fix l1/l2 calculation+gradient; add L1/L2 gradient check unit tests  