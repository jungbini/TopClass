  fix issue and optimize code  