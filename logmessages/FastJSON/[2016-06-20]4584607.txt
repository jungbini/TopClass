  bug fixed for issue #681  