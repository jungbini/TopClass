  improved generic support. fixed issue #569  