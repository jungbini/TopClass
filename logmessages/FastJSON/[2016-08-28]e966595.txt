  bug fixed for issue #778  