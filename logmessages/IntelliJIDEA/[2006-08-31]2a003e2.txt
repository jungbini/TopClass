  fixing getting targets and minor refactorings  