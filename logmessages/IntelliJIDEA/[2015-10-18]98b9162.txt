  Add annotations and fix PY-17269  