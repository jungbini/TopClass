  rewrote to fix tons of bugs and rendering problems  