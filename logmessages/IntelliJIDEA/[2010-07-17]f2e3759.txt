  simple perf fix: don't visit the same roots twice  