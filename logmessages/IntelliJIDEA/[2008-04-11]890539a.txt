  fix for NPE and cleanup  