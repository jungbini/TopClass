  type cook cleanup and obsolete casts fix  