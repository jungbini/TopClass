  fixed exception about repaint not in correct thread  