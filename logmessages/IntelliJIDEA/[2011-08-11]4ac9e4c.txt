  Fixed some ugly bugs; should be better now.  