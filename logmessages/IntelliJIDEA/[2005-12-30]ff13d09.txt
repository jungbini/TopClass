  fix for IDEADEV-3938 and significant performance enhancement  