  made lock free + potential race fixed  