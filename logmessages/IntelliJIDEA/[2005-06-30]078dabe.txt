  IDEADEV-1646 fixed + minor improvement.  