  Apply patch: new algorithm for candidate files search: 1) look for by file name  if there are several files with that name, select between them: 2) select those with full path matches (a/b/c/d/file) 3) make a look inside a patch and check [partially] whether context could be found and weight matching  if there're relative paths (it is possible when you create patch from IDEA and the root is outside the project directory), try to find by exact path starting from project directory. It will fix cases when we have versioned directories but not under project scope (can not use index to search there)  will fix IDEA-56110 "Apply patch" applies changes to the wrong file. and IDEA-53865 "Failed to apply patch for file ...: couldn't find context" (wrong base directory guess case)  