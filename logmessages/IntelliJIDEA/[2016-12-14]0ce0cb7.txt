lt less dependent on the order of channels.  (cherry picked from commit e86b03d)  