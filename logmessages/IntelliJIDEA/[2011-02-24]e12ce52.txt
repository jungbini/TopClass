  "Confusing 'else' branch" fixes and tests  