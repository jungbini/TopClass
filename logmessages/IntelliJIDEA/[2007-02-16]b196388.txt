  refactorings +  fix NPE from Zheka  