  [dsm] bunch of fixes and improvements  