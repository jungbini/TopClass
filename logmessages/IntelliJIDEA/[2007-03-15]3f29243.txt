  cleanup and fix for possible NPE  