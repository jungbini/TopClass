erry picked from commit 685cd642d3f0a8ecffd978ad7a393eaae8f5d995)  