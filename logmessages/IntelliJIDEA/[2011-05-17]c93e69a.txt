  separate column for type. correct error handling. empty string handling & escaping fixes.  