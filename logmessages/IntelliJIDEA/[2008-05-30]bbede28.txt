  fix smart completion after cast, enlighten tests  