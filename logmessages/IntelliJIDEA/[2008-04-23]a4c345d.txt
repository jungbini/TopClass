  integrate ven's type inference fix with test  