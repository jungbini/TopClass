  Pull request #100 by evra + some small cleanups and style fixes by klikh  