rom commit e82ef8e1e276ae232afc582f12b55b0ba727d07a) (cherry picked from commit 0d1984cd39a1239428e67ae3bdc8df67d740e4b2)  