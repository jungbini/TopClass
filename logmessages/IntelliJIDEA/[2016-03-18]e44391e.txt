  automatic transaction nesting: correct modality state checks, honor in submitTransaction (and remove "later" semantics from it, fix the only client that cares)  