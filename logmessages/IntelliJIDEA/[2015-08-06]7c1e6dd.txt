  Refactor relations between components and some fixes  