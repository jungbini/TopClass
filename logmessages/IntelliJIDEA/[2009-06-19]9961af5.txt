  few more refactoring with HierarchyBrowsers, common code extracted to base classes + few fixes  