  avoid mem leaks and fix IDEA-76436 Directory 