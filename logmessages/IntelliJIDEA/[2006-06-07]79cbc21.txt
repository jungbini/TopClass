  refeactored, added "create macrodef" quick-fix  