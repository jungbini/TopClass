rom commit 5b2a648c979be2d7ed3fc5c93652a81f72a61e79) (cherry picked from commit bae40a3a78d7747be7dc19723dc98ef8fff48697)  