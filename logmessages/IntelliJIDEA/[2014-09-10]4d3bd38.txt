  fix NPE, simplify  now we can use data context  