  Port fix for #597 #603 #615 #586 #625  