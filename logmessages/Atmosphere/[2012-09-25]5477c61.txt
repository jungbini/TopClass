  Final fix for #646  