  Tentative fix for #646 Patch provided by Paul Khodchenkov  