  lots of work on in-memory mapping. fixed a bug in Transpose. general refactoring.  