  fixed cleanup methods to protected against accidental closing of sockets.  