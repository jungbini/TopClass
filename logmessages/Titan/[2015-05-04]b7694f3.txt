  Updated to TP3 M9rc1 and attempted to fix all compile errors. Tests have not yet been run.  