nvolved.  These changes seem to work in unit and limited manual testing on my workstation, but the code is all very new and may be buggy.  