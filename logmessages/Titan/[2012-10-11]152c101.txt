  refactored test cases, added test cases for new functionality, fixed bugs  