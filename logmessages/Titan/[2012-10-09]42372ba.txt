  Finished refactoring - now on to bugfixing  