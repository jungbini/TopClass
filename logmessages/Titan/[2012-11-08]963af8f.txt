  fixed a semantic bug in SideEffectMap. Mixing depth-first and breadth-first semantics.  