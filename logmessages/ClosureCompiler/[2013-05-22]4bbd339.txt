  Side-effect analysis improvements fixes issue 1004 R=blickly,johnlenz  