  - more refactoring and fixing of some bugs  