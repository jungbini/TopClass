  cherry-picking to master: fixing bug reported in issue #23  